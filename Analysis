Sub analysis()
    Dim Ticker As String
    Dim YearlyChange As Double
    Dim PercentChange As Double
    Dim TotalVolume As Double
    TotalVolume = 0
    
    Range("I1").Value = "Ticker"
    Range("J1").Value = "Yearly Change"
    Range("K1").Value = "Percent Change"
    Range("L1").Value = "Total Stock Volume"
    
    Dim OpenPrice As Double
    OpenPrice = Range("C2").Value
    
    Dim ClosePrice As Double
    Dim LastRow As Long
    Dim TickerRow As Integer
    TickerRow = 2
    
    LastRow = Cells(Rows.Count, 1).End(xlUp).Row
  
    Dim i As Long
    
    For i = 2 To LastRow
        If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then
            Ticker = Cells(i, 1).Value
            TotalVolume = TotalVolume + Cells(i, 7).Value
            Range("I" & TickerRow).Value = Ticker
            Range("L" & TickerRow).Value = TotalVolume
            ClosePrice = Cells(i, 6).Value
            YearlyChange = ClosePrice - OpenPrice
            Range("J" & TickerRow).Value = YearlyChange            
                If OpenPrice = 0 Then
                    PercentChange = 0
                Else
                    PercentChange = YearlyChange / OpenPrice
                End If
            Range("K" & TickerRow).Value = PercentChange
            Range("K" & TickerRow).NumberFormat = "0.00%"

            TickerRow = TickerRow + 1
            
            TotalVolume = 0
            
            OpenPrice = Cells(i + 1, 3)
        Else
            TotalVolume = TotalVolume + Cells(i, 7).Value
        End If
    Next i
    
    
    
End Sub
